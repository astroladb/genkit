# Genkit

A lightweight parser that reads OpenAPI 3.x with custom `x-db` metadata and outputs a dual-view schema (flat array + namespace groups) for building code generators.

**Works with [AstrolaDB](https://github.com/hlop3z/astroladb)**: Parse OpenAPI specs generated by AstrolaDB and build custom generators in any language or framework.

## Quick Start

```bash
pnpm install
pnpm example
```

## Usage

```typescript
import { parseOpenAPISchema } from "./src/lib/parser";

const schema = parseOpenAPISchema(openapi);

// Flat array - single-file generators
schema.tables.forEach((table) => console.log(table));

// Grouped by namespace - multi-file generators
Object.entries(schema.models).forEach(([ns, tables]) => {
  files[`${ns}/models.py`] = buildModels(tables);
});
```

## Input: OpenAPI + `x-db`

```json
{
  "components": {
    "schemas": {
      "AuthUser": {
        "x-db": { "namespace": "auth", "table": "auth_user" },
        "properties": {
          "id": { "x-db": { "sql_type": { "postgres": "UUID" } } }
        }
      }
    }
  }
}
```

## Output

```typescript
{
  tables: [{ namespace: "auth", name: "AuthUser", table: "auth_user", columns: [...] }],
  models: { "auth": [{ name: "AuthUser", ... }] }
}
```

## AstrolaDB Integration

This parser is designed to work with [AstrolaDB](https://github.com/hlop3z/astroladb)'s OpenAPI output:

**The Flow:**

```text
AstrolaDB Schema → openapi.json (with x-db) → Genkit Parser → Custom Generators
```

1. **AstrolaDB** defines schemas once and generates `openapi.json` with `x-db` extensions
2. **Genkit** parses the OpenAPI spec into dual-view schema
3. **Your generators** use the schema to generate code in any language/framework

This enables extending AstrolaDB's code generation to additional languages, frameworks, or custom outputs beyond the built-in generators.
